---
import Layout from '@layouts/Layout.astro';
import { getAllQuizzes } from '@lib/quizLoader';

export async function getStaticPaths() {
  const quizzes = await getAllQuizzes();

  return quizzes.map((quiz) => ({
    params: { date: quiz.data.meta.date },
    props: { quiz: quiz.data },
  }));
}

const { quiz } = Astro.props;
const { meta, questions } = quiz;
---

<Layout title={`${meta.topic} - Daily Quiz`} description={`Test your knowledge: ${meta.topic}`}>
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12">
      <!-- Quiz Header -->
      <div class="mb-8 text-center">
        <div class="inline-flex items-center space-x-2 bg-blue-100 dark:bg-blue-900/30 rounded-full px-4 py-1.5 mb-4">
          <span class="text-sm font-medium text-blue-700 dark:text-blue-300 capitalize">{meta.category}</span>
          <span class="text-blue-400 dark:text-blue-600">â€¢</span>
          <span class="text-sm font-medium text-blue-700 dark:text-blue-300 capitalize">{meta.difficulty}</span>
        </div>
        <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 dark:text-white mb-2">
          {meta.topic}
        </h1>
        <p class="text-gray-600 dark:text-slate-400">{meta.date}</p>
      </div>

      <!-- Quiz Container -->
      <div id="quiz-app" data-quiz={JSON.stringify(quiz)} class="animate-fade-in">
        <div class="bg-white dark:bg-slate-800 rounded-2xl p-8 shadow-lg border border-gray-200 dark:border-slate-700">
          <div class="flex items-center justify-center py-12">
            <div class="text-center">
              <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
              <p class="mt-4 text-gray-600 dark:text-slate-400">Loading quiz...</p>
            </div>
          </div>
        </div>
      </div>
    </div>

  <script src="../../components/QuizApp.ts"></script>
</Layout>
